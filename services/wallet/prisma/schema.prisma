generator client {
  provider = "prisma-client-js"
  binaryTargets = ["native", "darwin", "darwin-arm64", "linux-arm64-openssl-3.0.x"]
  output = "../node_modules/.prisma/client"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Wallet {
  id              String        @id @default(uuid())
  userId          String        @unique
  address         String        @unique
  encryptedKey    String        // Encrypted private key
  network         String        @default("sepolia")
  createdAt       DateTime      @default(now())
  transactions    Transaction[]

  @@index([userId])
  @@index([address])
  @@map("wallets")
}

model Transaction {
  id            String   @id @default(uuid())
  walletId      String
  wallet        Wallet   @relation(fields: [walletId], references: [id], onDelete: Cascade)
  type          String   // send/receive
  from          String
  to            String
  amount        String
  txHash        String   @unique
  status        String   // pending/completed/failed
  blockNumber   Int?
  gasUsed       String?
  gasPrice      String?
  nonce         Int
  createdAt     DateTime @default(now())

  @@index([walletId])
  @@index([txHash])
  @@index([status])
  @@map("transactions")
}

